<!DOCTYPE html>
<html>
  <head>
    <title>Tests</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato&display=swap"
      rel="stylesheet"
    />
    <style>
      ul {
        display: flex;
        list-style-type: none;
        padding: 1rem 0 0 1rem;
      }

      ul li {
        color: white;
        margin-right: 0.56rem;
      }

      a {
        display: block;
        text-decoration: none;
        color: black;
        padding: 1rem;
        border-radius: 0.56rem;
        background-color: white;
      }

      a:hover {
        background-color: powderblue;
      }

      #bramble-container {
        height: 500px;
        width: 500px;
      }

      body {
        background-color: black;
      }
    </style>
  </head>

  <body>
    <div id="bramble-container"></div>

    <script type="text/javascript" src="./bramble.js"></script>
    <script type="text/javascript">
      ;(async () => {
        const game = Bramble.game.create()
        const container = document.getElementById('bramble-container')

        game.attachTo(container)
        game.setSize(500, 500)

        const hero = {
          size: 50,
          position: { x: 0, y: 0 },
          hue: 1,
          rotation: 0
        }

        await game.assets.add('song', 'sound', 'test.mp3')

        let isPlaying = false

        game.setUpdate(({ dt, input, sfx, assets }) => {
          hero.position = input.mouse.position
          hero.hue += 1
          hero.rotation += 1

          if (input.mouse.left.justPressed) {
            if (isPlaying) {
              isPlaying = false
              sfx.stop('song')
            } else {
              isPlaying = true
              sfx.play('song')
            }
          }

          // console.log(assets.sounds.get('song'))
          // exit
        })

        game.setRender(({ gfx }) => {
          gfx.clear('black')

          for (let i = 0; i < 15; i++) {
            gfx.rotation(
              () => {
                gfx.blur(() => {
                  gfx.rotation(() => {
                    gfx.circle({ x: i * (25 + 10), y: i * (25 + 10) }, 25, {
                      fill: { colour: 'red' },
                      line: { width: 0 }
                    })
                  }, hero.rotation)
                }, i * 2)
              },
              (hero.rotation + ( i)) / 10,
              { x: 250, y: 250 }
            )
          }
        })

        game.start()
      })()
    </script>
  </body>
</html>
