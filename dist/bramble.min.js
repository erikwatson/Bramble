!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Bramble=t():e.Bramble=t()}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/js/",n(n.s=1)}([function(e,t){function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=[],r=0;r<t;r++){for(var l=[],i=0;i<e;i++)l.push(n);o.push(l)}return o}var i={pos:{x:0,y:0},visible:!0,divisions:4,tileWidth:8,tileHeight:8,scale:1};e.exports={create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;n=o({},i,{},n);var r=l(e,t,0),a={x:n.pos.x,y:n.pos.y},c=n.visible,d=n.divisions,u=n.tileWidth,s=n.tileHeight,f=n.tileWidth,b=n.scale;return{divisions:d,pos:a,tileHeight:s,tiles:r,tileWidth:u,visible:c,width:e,height:t,tileSize:f,scale:b}}}},function(e,t,n){"use strict";n.r(t);var o={create:function(e,t,n,o){return{name:e,type:t,image:n,tiles:o}}};function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";return new Promise((function(n,o){var r=new XMLHttpRequest;r.responseType=t,r.addEventListener("load",(function(e){switch(t){case"text":n(e.target.responseText);break;case"json":n(e.target.response);break;default:console.error("invalid type provided to load: ".concat(t," is unknown"))}})),r.addEventListener("error",(function(e){o(e)})),r.open("GET",e,!0),r.send()}))}function l(e){return r(e,"json")}function i(e){return new Promise((function(t,n){var o=new Image;o.addEventListener("load",(function(e){t(o)})),o.addEventListener("error",(function(e){n(e)})),o.src=e}))}function a(e){return new Promise((function(t,n){var o=new Audio;o.addEventListener("canplaythrough",(function(e){t(o)})),o.addEventListener("error",(function(e){n(e)})),o.src=e}))}function c(e){var t=null;return l(e).then((function(e){return i((t=e).path)})).then((function(e){return o.create(t.name,t.type,e,t.tiles)})).catch((function(e){console.error(e)}))}var d={loadText:function(e){return r(e,"text")},loadJson:l,loadImage:i,loadAllText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(e.map((function(e){return r(e,"text")})))},loadAllImages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(e.map((function(e){return i(e)})))},loadSound:a,loadAllSounds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(e.map((function(e){return a(e)})))},loadTerrain:c,loadAllTerrain:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(e.map((function(e){return c(e)})))}};var u={toRadians:function(e){return e*(Math.PI/180)},toDegrees:function(e){return e*(180/Math.PI)}},s=null;var f={fill:{color:"#ffffff",opacity:1},line:{width:2,color:"#000000",opacity:1}};function b(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:f;void 0!==r.fill&&(s.fillStyle=r.fill.color,s.fillRect(e,t,n,o)),void 0!==r.line&&(s.strokeStyle=r.line.color,s.lineWidth=r.line.width,s.strokeRect(e,t,n,o))}var h={width:2,color:"#000000"};var p={fill:{color:"#000000",opacity:1},line:{color:"#ffffff",opacity:1,width:2}};function v(e,t,n,o,r){s.drawImage(r,e,t,n,o)}function g(e,t,n,o,r,l,i,a,c){s.drawImage(c,r,l,i,a,e,t,n,o)}var m={shadowColor:"#000000",shadowBlur:6,shadowOffsetX:4,shadowOffsetY:4};var y={circle:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p;void 0!==o.fill&&(s.fillStyle=o.fill.color),s.beginPath(),s.strokeStyle=o.line.color,s.lineWidth=o.line.width,s.arc(e,t,n,0,2*Math.PI),s.closePath(),void 0!==o.fill&&s.fill(),s.stroke()},clear:function(e){b(0,0,s.canvas.width,s.canvas.height,{fill:{color:e}})},image:v,line:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;s.strokeStyle=n.color,s.lineWidth=n.width,s.beginPath(),s.moveTo(e.x,e.y),s.lineTo(t.x,t.y),s.stroke()},rect:b,getContext:function(){return s},setContext:function(e){s=e},sprite:function(e){var t=e.width/2,n=e.height/2;s.save(),s.translate(e.x+t,e.y+n),s.rotate(u.toRadians(e.rotation)),e.frames.length>1?g(-t,-n,e.width,e.height,e.frames[e.frame].x,e.frames[e.frame].y,e.frames[e.frame].width,e.frames[e.frame].height,e.texture):v(-t,-n,e.width,e.height,e.texture),s.restore()},square:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:f;b(e,t,n,n,o)},subImage:g,text:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#000000",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"16pt sans-serif";s.fillStyle=o,s.font=r,s.textAlign="left",s.textBaseline="top",s.fillText(n,e,t)},textbox:function(e){s.fillStyle="#ffffff",s.font="16pt sans-serif",s.textAlign="left",s.textBaseline="top",s.measureText(e.text).width>e.width&&(e.text=e.text.substr(0,10)+"\n"+e.text.substr(10)),s.fillText(e.text,e.x,e.y)},tiles:function(e,t,n,o,r,l,i){for(var a=1,c=2,d=4,u=8,s=16,f=32,b=64,h=128,p=function(l){for(var i=function(i){if(0===n[l][i])return"continue";var p=l>0?n[l-1][i-1]:0,v=l>0?n[l-1][i]:0,m=l>0?n[l-1][i+1]:0,y=n[l][i-1],w=n[l][i],O=n[l][i+1],x=l<n.length-1?n[l+1][i-1]:0,j=l<n.length-1?n[l+1][i]:0,P=l<n.length-1?n[l+1][i+1]:0,S=a*(w===v&&w===y&&w===p?1:0)+c*(w===v?1:0)+d*(w===v&&w===O&&w===m?1:0)+u*(w===O?1:0)+s*(w===j&&w===O&&w===P?1:0)+f*(w===j?1:0)+b*(w===j&&w===y&&w===x?1:0)+h*(w===y?1:0),k=o.filter((function(e){return e.type===n[l][i]}))[0],E=k.tiles.filter((function(e){return e.type===S})),C=E[Math.floor(Math.random()*E.length)];C?function(e,t,n,o,r,l,i,a,c,d){g(e+a*(o*c),t+a*(r*d),a*c,a*d,c*l,d*i,c,d,n)}(e,t,k.image,i,l,C.position.x,C.position.y,r,C.size.width,C.size.height):console.log("Tile not defined ".concat(S))},p=0;p<n[l].length;p++)i(p)},v=0;v<n.length;v++)p(v)},shadow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;s.save(),s.shadowColor=t.shadowColor,s.shadowBlur=t.shadowBlur,s.shadowOffsetX=t.shadowOffsetX,s.shadowOffsetY=t.shadowOffsetY,e(),s.restore()},dodge:function(e){s.save(),s.globalCompositeOperation="color-dodge",e(),s.restore()},overlay:function(e){s.save(),s.globalCompositeOperation="overlay",e(),s.restore()},transparency:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25;s.save(),s.globalAlpha=t,e(),s.restore()}},w=document.createElement("canvas"),O=w.getContext("2d");var x={element:w,setSize:function(e,t){w.width=e,w.height=t},attachTo:function(e){e.appendChild(w),y.setContext(O)},setSmoothing:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];O.imageSmoothingEnabled=e},disableContextMenu:function(){w.addEventListener("contextmenu",(function(e){e.preventDefault()}))}};function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S,k=(S={pressed:!1,justPressed:!1,released:!1,justReleased:!1},[{code:8,label:"backspace"},{code:9,label:"tab"},{code:13,label:"enter"},{code:16,label:"shift"},{code:17,label:"ctrl"},{code:18,label:"alt"},{code:20,label:"caps"},{code:27,label:"escape"},{code:32,label:"space"},{code:33,label:"pageUp"},{code:34,label:"pageDown"},{code:35,label:"end"},{code:36,label:"home"},{code:37,label:"left"},{code:38,label:"up"},{code:39,label:"right"},{code:40,label:"down"},{code:45,label:"insert"},{code:46,label:"delete"},{code:48,label:"zero"},{code:49,label:"one"},{code:50,label:"two"},{code:51,label:"three"},{code:52,label:"four"},{code:53,label:"five"},{code:54,label:"six"},{code:55,label:"seven"},{code:56,label:"eight"},{code:57,label:"nine"},{code:65,label:"A"},{code:66,label:"B"},{code:67,label:"C"},{code:68,label:"D"},{code:69,label:"E"},{code:70,label:"F"},{code:71,label:"G"},{code:72,label:"H"},{code:73,label:"I"},{code:74,label:"J"},{code:75,label:"K"},{code:76,label:"L"},{code:77,label:"M"},{code:78,label:"N"},{code:79,label:"O"},{code:80,label:"P"},{code:81,label:"Q"},{code:82,label:"R"},{code:83,label:"S"},{code:84,label:"T"},{code:85,label:"U"},{code:86,label:"V"},{code:87,label:"W"},{code:88,label:"X"},{code:89,label:"Y"},{code:90,label:"Z"},{code:91,label:"superLeft"},{code:92,label:"superRight"},{code:93,label:"select"},{code:96,label:"num0"},{code:97,label:"num1"},{code:98,label:"num2"},{code:99,label:"num3"},{code:100,label:"num4"},{code:101,label:"num5"},{code:102,label:"num6"},{code:103,label:"num7"},{code:104,label:"num8"},{code:105,label:"num9"},{code:106,label:"multiply"},{code:107,label:"add"},{code:109,label:"subtract"},{code:110,label:"point"},{code:111,label:"divide"},{code:112,label:"F1"},{code:113,label:"F2"},{code:114,label:"F3"},{code:115,label:"F4"},{code:116,label:"F5"},{code:117,label:"F6"},{code:118,label:"F7"},{code:119,label:"F8"},{code:120,label:"F9"},{code:121,label:"F10"},{code:122,label:"F11"},{code:123,label:"F12"},{code:144,label:"numLock"},{code:145,label:"scrollLock"},{code:186,label:"semiColon"},{code:187,label:"equals"},{code:188,label:"comma"},{code:189,label:"dash"},{code:190,label:"dot"},{code:191,label:"forewardSlash"},{code:192,label:"graveAccent"},{code:219,label:"openBracket"},{code:220,label:"backSlash"},{code:221,label:"closeBracket"},{code:222,label:"singleQuote"}].reduce((function(e,t){var n=t.label;return delete t.label,e[n]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{},S),e}),{}));function E(e,t){for(var n=null,o=Object.keys(t),r=0;r<o.length;r++)t[o[r]].code===e.keyCode&&(n=t[o[r]]);return n}function C(e){!function(e){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&e.preventDefault()}(e),E(e,k).pressed=!0}function L(e){E(e,k).pressed=!1}var T={start:function(){document.addEventListener("keydown",C),document.addEventListener("keyup",L)},update:function(){},state:k};function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}R();var F=R();function M(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},{pressed:!1,justPressed:!1,released:!1,justReleased:!1},{moved:!1})}function R(){return{x:0,y:0,left:{pressed:!1,justPressed:!1,released:!1,justReleased:!1},wheel:M(),right:{pressed:!1,justPressed:!1,released:!1,justReleased:!1}}}function B(e){var t=function(e,t){var n=w.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}(e);F.x=t.x,F.y=t.y}function I(e){switch(e.which){case 1:F.left.pressed=!0;break;case 2:F.middle.pressed=!0;break;case 3:F.right.pressed=!0}}function W(e){switch(e.which){case 1:F.left.pressed=!1;break;case 2:F.middle.pressed=!1;break;case 3:F.right.pressed=!1}}function z(e){F.wheel.moved=0!==e.delta,!1!==F.wheel.moved&&(F.wheel.direction=e.deltaY<0?"up":"down")}var X={start:function(){w.addEventListener("mousemove",B),w.addEventListener("mousedown",I),w.addEventListener("mouseup",W),w.addEventListener("wheel",z),F.x=w.width/2,F.y=w.height/2},update:function(){var e;F.wheel.moved=!1,e=F,Object.assign({},e)},state:F};var Y=T.state,_=X.state,q={start:function(){T.start(),X.start()},update:function(){T.update(),X.update()}},H="#000000",U=null,G=null;function J(){U&&U(1/60),G&&(y.clear(H),G()),q.update(),window.requestAnimationFrame(J)}var Q={setSize:x.setSize,setUpdate:function(e){U=e},setRender:function(e){G=e},setBackgroundColor:function(e){H=e},attachTo:x.attachTo,disableContextMenu:x.disableContextMenu,setSmoothing:x.setSmoothing,start:function(){q.start(),window.requestAnimationFrame(J)}},K=n(0),N=n.n(K),V=(new AudioContext).createOscillator(),Z={play:function(){V.start(),V.connect(V.destination)}},$={},ee={};function te(e,t){for(var n in t){(l=t[n]).configurable=l.enumerable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,n,l)}if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(t),r=0;r<o.length;r++){var l,i=o[r];(l=t[i]).configurable=l.enumerable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,i,l)}return e}var ne={create:function(){var e,t,n,o,r,l,i,a,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,b=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"#ffffff",p=[];return i={x:c,y:d,width:u,height:s,rotation:f,texture:b,color:h,frame:0,setFrames:function(e){p=e},addFrame:function(e){p.push(e)},get frames(){return p}},(a={})[e="x"]=a[e]||{},a[e].get=function(){return c},a[t="x"]=a[t]||{},a[t].set=function(e){c=e},a[n="y"]=a[n]||{},a[n].get=function(){return d},a[o="y"]=a[o]||{},a[o].set=function(e){d=e},a[r="rotation"]=a[r]||{},a[r].get=function(){return f},a[l="rotation"]=a[l]||{},a[l].set=function(e){f=e>=360?360-e:e},te(i,a),i}};var oe={create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return{x:e,y:t,width:n,height:o,text:r}}};n.d(t,"assets",(function(){return d})),n.d(t,"game",(function(){return Q})),n.d(t,"grid",(function(){return N.a})),n.d(t,"graphics",(function(){return y})),n.d(t,"keyboard",(function(){return Y})),n.d(t,"mouse",(function(){return _})),n.d(t,"music",(function(){return $})),n.d(t,"sfx",(function(){return ee})),n.d(t,"sprite",(function(){return ne})),n.d(t,"textbox",(function(){return oe})),n.d(t,"sound",(function(){return Z}))}])}));